import{r as l,o as k,c as B,a,u as N,w as c,F as P,Z as R,d as o,v as A,b as x,y as C,B as F,aU as M,h as U}from"./app-4942be61.js";import{L as D}from"./LayoutCalificador-33498b6e.js";import{r as V,u as E}from"./xlsx-4f9172c7.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-65865e53.js";import"./logotiny-c4b525af.js";/* empty css                                                                          */import"./TopMenu-acf9475b.js";import"./DownOutlined-8a0e9428.js";import"./AntdIcon-7f1e898e.js";const O={class:"p-4",style:{width:"100%","max-width":"1300px",background:"white","border-radius":"8px"}},G={class:"flex justify-between"},T={style:{display:"flex","justify-content":"flex-end"}},Z={style:{display:"flex"}},q={__name:"SubirResultado",setup(z){const i=l([]),s=l(0),p=l(""),m=async()=>{s.value=0;try{const t=await C.post("subir-excel-simulacro",{data:i.value},{onUploadProgress:e=>{e.lengthComputable&&(s.value=Math.round(e.loaded/e.total*100))}});console.log("Respuesta del servidor:",t.data),s.value=100}catch(t){s.value=70,p.value="exception",console.error("Error:",t)}},b=t=>{const e=t.target.files[0],r=new FileReader;r.onload=d=>{const u=new Uint8Array(d.target.result),n=V(u,{type:"array"}),y=n.SheetNames[0],v=n.Sheets[y],_=E.sheet_to_json(v,{header:1}),g=_[0],w=_.slice(1).map(I=>{const f={};return g.forEach((S,j)=>{f[S]=I[j]}),f});i.value=w},r.readAsArrayBuffer(e)},h=l([{title:"DNI",dataIndex:"dni"},{title:"Ap. Paterno",dataIndex:"paterno"},{title:"Ap. Materno",dataIndex:"materno"},{title:"Mombres",dataIndex:"nombres"},{title:"Puntaje",dataIndex:"puntaje"},{title:"Fecha",dataIndex:"fecha"},{title:"Puesto Programa",dataIndex:"puesto_programa"},{title:"Puesto General",dataIndex:"puesto_general"}]);return(t,e)=>{const r=F,d=M,u=U;return k(),B(P,null,[a(N(R),{title:"Inicio"}),a(D,null,{default:c(()=>[o("div",O,[o("form",{onSubmit:e[0]||(e[0]=A((...n)=>t.submit&&t.submit(...n),["prevent"]))},[o("div",G,[o("input",{type:"file",onChange:b},null,32),o("div",T,[a(r,{class:"mr-2",style:{"border-radius":"5px",height:"38px",border:"solid 1px var(--primary-color)",color:"var(--primary-color)"},onClick:m},{default:c(()=>e[1]||(e[1]=[x("Ejemplo")])),_:1}),a(r,{style:{height:"38px","border-radius":"5px",border:"none",color:"white",background:"var(--primary-color)"},onClick:m},{default:c(()=>e[2]||(e[2]=[x(" Subir resultado")])),_:1})])])],32),o("div",Z,[a(d,{percent:s.value,status:p.value},null,8,["percent","status"])]),o("div",null,[a(u,{dataSource:i.value,columns:h.value},null,8,["dataSource","columns"])])])]),_:1})],64)}}},oe=L(q,[["__scopeId","data-v-84322550"]]);export{oe as default};
